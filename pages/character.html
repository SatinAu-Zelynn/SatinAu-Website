<!--
  Copyright 2025 缎金SatinAu

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>设定总览 - 泽凌Zelynn</title>
  <meta name="description" content="泽凌Zelynn的设定总览">
  <meta name="keywords" content="缎金,泽凌,Zelynn,福瑞,Furry,兽设,设定,角色,OC">
  <meta name="author" content="缎金SatinAu">
  <meta name="color-scheme" content="light dark">
  <meta name="supported-color-schemes" content="light dark">
  <link rel="canonical" href="https://satinau.cn/pages/character">
  <link rel="icon" type="image/x-icon" href="/public/favicon.ico">
  <link rel="stylesheet" href="/src/style.css">
  <link rel="preload" href="https://font.sec.miui.com/font/css?family=MiSans:200,300,400,450,500,600,650,700:Chinese_Simplify,Latin&display=swap" as="style" onload='this.onload=null,this.rel="stylesheet"'>
  <script src="/src/script/config.js"></script>
  <script src="/src/script/common.js" defer></script>
  <script src="/src/script/components/CRCMenu.js"></script>
  <script src="/src/script/components/GlobalModal.js" defer></script>
  <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "trwlkhxzch");
  </script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    iframe {
      width: 90%;
      height: 80%;
      margin-top: 16vh;
      border: none;
      border-radius: 12px;
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
      background: #fff;
      transition: all 0.4s ease;
      z-index: 10;
    }

    /* 全屏模式下的 iframe 样式 */
    iframe.fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100% !important;
      height: 100% !important;
      margin: 0 !important;
      border-radius: 0 !important;
      z-index: 2100; /* 高于导航栏(2001)和遮罩 */
    }

    /* 放大/缩小 悬浮按钮 */
    .zoom-btn {
      position: fixed;
      /* 位于导航栏上方一点的位置，适配移动端 */
      bottom: calc(var(--nav-height) + env(safe-area-inset-bottom, 0px) + 60px);
      right: 30px;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: light-dark(rgba(255,255,255,0.6), rgba(40,40,40,0.6));
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid light-dark(rgba(255,255,255,0.35), rgba(255,255,255,0.12));
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2200; /* 始终位于 iframe 之上 */
      cursor: var(--custom-cursor, pointer);
      transition: all 0.3s cubic-bezier(0.22, 1, 0.36, 1);
      color: var(--word-color);
    }

    @media (min-width: 768px) {
      .zoom-btn {
        bottom: 30px;
        right: 30px;
      }
    }

    .zoom-btn:hover {
      transform: scale(1.1);
      background: var(--primary-color);
      color: white;
      box-shadow: 0 12px 24px rgba(0,0,0,0.2);
    }

    .zoom-btn:active {
      transform: scale(0.95);
    }

    .zoom-btn svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
      transition: transform 0.3s ease;
    }

    @media (max-width: 768px) {
      body {
        align-items: flex-end;
      }

      iframe {
        height: 90%;
        margin-bottom: 2vh;
      }
      
      /* 全屏模式下取消 body 的对齐影响 */
      body:has(iframe.fullscreen) {
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <!-- 背景色块 -->
  <div class="color-bg color-bg-1"></div>
  <div class="color-bg color-bg-2"></div>
  <div class="color-bg color-bg-3"></div>
  <div class="color-bg color-bg-4"></div>

  <!-- 放大/缩小按钮 -->
  <button id="zoomBtn" class="zoom-btn" title="全屏查看 / Fullscreen">
    <!-- 默认显示放大图标 -->
    <svg id="icon-expand" viewBox="0 0 24 24">
      <path d="M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3h-6zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3v6zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6h6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6v-6z"/>
    </svg>
    <!-- 缩小图标（初始隐藏） -->
    <svg id="icon-compress" viewBox="0 0 24 24" style="display: none;">
      <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-14v3h3v2h-5V5z"/>
    </svg>
  </button>

  <iframe id="docFrame" src="" title="设定总览 / Character Overview"></iframe>

  <script>
    const params = new URLSearchParams(window.location.search);
    const lang = params.get("lang") || "zh-cn";

    const docUrls = {
      "zh-cn": "https://www.kdocs.cn/l/cbnmJFr498XG",
      "zh-tw": "https://www.kdocs.cn/l/caB01lLIj8q2",
      "en": "https://www.kdocs.cn/l/cjSN22oChlaT"
    };

    const iframe = document.getElementById("docFrame");
    iframe.src = docUrls[lang] || docUrls["zh-cn"];

    // --- 全屏缩放逻辑 ---
    const zoomBtn = document.getElementById('zoomBtn');
    const iconExpand = document.getElementById('icon-expand');
    const iconCompress = document.getElementById('icon-compress');

    zoomBtn.addEventListener('click', function() {
      // 切换 Iframe 的全屏样式
      const isFullscreen = iframe.classList.toggle('fullscreen');

      // 获取导航栏元素
      const navBar = document.querySelector('.bottom-nav');

      if (navBar) {
        if (isFullscreen) {
          // 隐藏导航栏
          navBar.classList.add('nav-hidden');
          
          // 如果有移动端的更多菜单打开，也应该关掉
          const mobileMenu = document.querySelector('.mobile-more-menu');
          if (mobileMenu) mobileMenu.classList.remove('show');
          navBar.classList.remove('menu-open');
        } else {
          // 显示导航栏
          navBar.classList.remove('nav-hidden');
        }
      }

      // 切换图标
      if (isFullscreen) {
        iconExpand.style.display = 'none';
        iconCompress.style.display = 'block';
        zoomBtn.title = "退出全屏 / Exit Fullscreen";
      } else {
        iconExpand.style.display = 'block';
        iconCompress.style.display = 'none';
        zoomBtn.title = "全屏查看 / Fullscreen";
      }
    });
  </script>

  <!-- 加载动画 -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast"></div>

  <!-- 弹窗组件 -->
  <global-modal id="globalModal"></global-modal>

  <!-- 导航栏 -->
  <script src="/src/script/components/navigate.js"></script>
  <navigate-bar></navigate-bar>
</body>
</html>